(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{132:function(e,t,a){},156:function(e,t,a){e.exports=a(341)},165:function(e,t,a){},193:function(e,t){},196:function(e,t,a){},197:function(e,t,a){},341:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(10),c=a.n(s),u=a(49),o=a(68),i=(a(165),a(4)),l=a.n(i),m=a(8),p=a(24),f=a(145),d=a.n(f),g=(a(196),a(343)),v=a(72),E=a(345),w=(a(197),function(e){return r.a.createElement(E.a,{className:"chat-input",placeholder:"Message",value:e.chatText,onChange:function(t){return e.setChatText(t.target.value)},onPressEnter:e.handleEnter})}),h=function(e){return r.a.createElement("div",null,r.a.createElement(g.a,{onContextMenu:e.handleContextMenu},r.a.createElement("strong",null,e.username),r.a.createElement("div",null,r.a.createElement("p",null,e.message))))},b=a(344),y=a(17),O=a(346),x=(a(132),a(31)),j=a.n(x),k={login:function(){var e=Object(m.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/login",t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),register:function(){var e=Object(m.a)(l.a.mark(function e(t){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post("/register",t);case 2:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},M=b.a.create()(function(e){var t=e.form,a=t.getFieldDecorator,n=t.validateFields;return r.a.createElement("div",{className:"container"},r.a.createElement(b.a,{onSubmit:function(t){t.preventDefault(),n(function(){var t=Object(m.a)(l.a.mark(function t(a,n){var r,s;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a&&console.log("Wrong values were entered"),r={username:n.username,password:n.password},t.next=4,k.login(r);case 4:s=t.sent,e.setActiveUser(s.username),e.setDisplayPage("CHAT"),n.remember&&window.localStorage.setItem("loggedUser",JSON.stringify(r));case 8:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}())},className:"login-form"},r.a.createElement(b.a.Item,null,a("username",{rules:[{required:!0,message:"Please input your username"}]})(r.a.createElement(E.a,{prefix:r.a.createElement(y.a,{type:"user"}),placeholder:"Username"}))),r.a.createElement(b.a.Item,null,a("password",{rules:[{required:!0,message:"Please input your Password"}]})(r.a.createElement(E.a,{prefix:r.a.createElement(y.a,{type:"lock"}),type:"password",placeholder:"Password"}))),r.a.createElement(b.a.Item,null,a("remember",{valuePropName:"checked",initialValue:!0})(r.a.createElement(O.a,null,"Remember me")),r.a.createElement(g.a,null,r.a.createElement(v.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Log in")),"Or ",r.a.createElement("a",{onClick:function(t){t.preventDefault(),e.setDisplayPage("REGISTER")}},"register now!"))))}),N=b.a.create()(function(e){var t=e.form,a=t.getFieldDecorator,n=t.validateFields;return r.a.createElement("div",{className:"container"},r.a.createElement(b.a,{onSubmit:function(t){t.preventDefault(),n(function(){var t=Object(m.a)(l.a.mark(function t(a,n){var r;return l.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return a&&console.log("Wrong values were entered"),r={username:n.username,password:n.password},t.next=4,k.register(r);case 4:e.setDisplayPage("LOGIN");case 5:case"end":return t.stop()}},t)}));return function(e,a){return t.apply(this,arguments)}}())},className:"login-form"},r.a.createElement(b.a.Item,null,a("username",{rules:[{required:!0,message:"Please input your username"}]})(r.a.createElement(E.a,{prefix:r.a.createElement(y.a,{type:"user"}),placeholder:"Username"}))),r.a.createElement(b.a.Item,null,a("password",{rules:[{required:!0,message:"Please input your Password"}]})(r.a.createElement(E.a,{prefix:r.a.createElement(y.a,{type:"lock"}),type:"password",placeholder:"Password"}))),r.a.createElement(g.a,null,r.a.createElement(v.a,{type:"primary",htmlType:"submit",className:"login-form-button"},"Register"))))}),D=a(105),I=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"NEW":return e?e.concat(t.data):t.data;case"EDIT":var a=Object(D.a)(e),n={message:t.message,username:t.username,id:t.id};return a.map(function(e){return e.id===t.id?n:e});case"DELETE":return Object(D.a)(e).filter(function(e){return e.id!==t.id});default:return e}},S="/api/messages",P={getMessages:function(){var e=Object(m.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.get(S);case 2:return t=e.sent,e.abrupt("return",t.data);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),sendMessage:function(){var e=Object(m.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.post(S,t);case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),updateMessage:function(){var e=Object(m.a)(l.a.mark(function e(t,a){var n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.put("".concat(S,"/").concat(a),t);case 2:return n=e.sent,e.abrupt("return",n.data);case 4:case"end":return e.stop()}},e)}));return function(t,a){return e.apply(this,arguments)}}(),deleteMessage:function(){var e=Object(m.a)(l.a.mark(function e(t){var a;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,j.a.delete("".concat(S,"/").concat(t));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()},T=d()("http://localhost:3001"),C={sendMessage:function(e){return{type:"NEW",data:e}},editMessage:function(e,t,a){return{type:"EDIT",message:e,username:t,id:a}},deleteMessage:function(e){return{type:"DELETE",id:e}}},L=Object(o.b)(function(e){return{message:e.message}},C)(function(e){var t=Object(n.useState)("LOGIN"),a=Object(p.a)(t,2),s=a[0],c=a[1],u=Object(n.useState)(null),o=Object(p.a)(u,2),i=o[0],f=o[1],d=Object(n.useState)(!1),E=Object(p.a)(d,2),b=E[0],y=E[1],O=Object(n.useState)(""),x=Object(p.a)(O,2),j=x[0],k=x[1],D=Object(n.useState)(null),I=Object(p.a)(D,2),S=I[0],C=I[1],L=Object(n.useState)(!1),R=Object(p.a)(L,2),U=R[0],A=R[1],G=Object(n.useState)(0),W=Object(p.a)(G,2),q=W[0],F=W[1],J=Object(n.useState)(0),H=Object(p.a)(J,2),B=H[0],V=H[1],X=e.sendMessage,Y=e.message,$=r.a.createRef();Object(n.useEffect)(function(){window.addEventListener("click",function(){return y(!1)}),function(){var e=Object(m.a)(l.a.mark(function e(){var t;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,P.getMessages();case 2:t=e.sent,X(t);case 4:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}()();var t=window.localStorage.getItem("loggedUser");if(t){var a=JSON.parse(t);f(a),c("CHAT")}T.on("newMessage",function(e){return X(e)}),T.on("editMessage",function(t){return e.editMessage(t.message,t.username,t.id)}),T.on("deleteMessage",function(t){return e.deleteMessage(t.id)})},[]),Object(n.useEffect)(function(){i&&$.current.scrollIntoView()},[Y]),Object(n.useEffect)(function(){window.addEventListener("contextmenu",function(e){e.preventDefault()})},[b]);var z=function(){A(!0);var e=Y.filter(function(e){return e.id===S}).map(function(e){return e.message});k(e)},K=function(){var e=Object(m.a)(l.a.mark(function e(){return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:T.emit("deleteMessage",S);case 1:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}}(),Q=function(){var e=Object(m.a)(l.a.mark(function e(t){var a,n;return l.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t.preventDefault(),U?(a={message:t.target.value,username:i.username,id:S},T.emit("editMessage",a),A(!1)):(k(t.target.value),n={message:j,username:i.username},T.emit("newMessage",n)),k("");case 3:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),Z=function(){window.localStorage.removeItem("loggedUser"),f(null),c("LOGIN")},_={display:b?"":"none",position:"absolute",left:"".concat(q,"px"),top:"".concat(B,"px")},ee=function(){if(Y)return Y.map(function(e){return r.a.createElement(h,{key:e.id,handleContextMenu:function(t){return function(e,t,a){e.preventDefault(),i.username===t&&(y(!0),F(e.pageX),V(e.pageY),C(a))}(t,e.username,e.id)},username:e.username,message:e.message})})};return r.a.createElement("div",null,r.a.createElement(g.a,{type:"flex",justify:"center",className:"header"},r.a.createElement("h1",null,"Chat Application")),function(){switch(s){case"LOGIN":return r.a.createElement(M,{setActiveUser:f,setDisplayPage:c});case"CHAT":return r.a.createElement("div",null,r.a.createElement("div",{className:"chat-container"},r.a.createElement("div",{className:"message-container"},ee(),r.a.createElement("div",{ref:$})),r.a.createElement("div",{className:"context-menu",style:_},r.a.createElement("ul",null,r.a.createElement("li",{onClick:z},"Edit"),r.a.createElement("li",{onClick:K},"Delete"))),r.a.createElement(w,{chatText:j,setChatText:k,handleEnter:Q})),r.a.createElement(g.a,{type:"flex",justify:"center"},r.a.createElement(v.a,{onClick:Z},"Logout")));case"REGISTER":return r.a.createElement(N,{setDisplayPage:c})}}())});Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var R=Object(u.b)({message:I}),U=Object(u.c)(R),A=function(){console.log(U.getState()),c.a.render(r.a.createElement(o.a,{store:U},r.a.createElement(L,null)),document.getElementById("root"))};A(),U.subscribe(A),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[156,1,2]]]);
//# sourceMappingURL=main.a9b79236.chunk.js.map